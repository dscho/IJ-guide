%% LyX 2.0.3 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[11pt,a4paper,american,english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{listings}
\pagestyle{empty}
\setcounter{tocdepth}{2}
\setlength{\parskip}{\medskipamount}
\setlength{\parindent}{0pt}
\synctex=-1
\usepackage{color}
\usepackage{babel}
\usepackage{array}
\usepackage{longtable}
\usepackage{varioref}
\usepackage{prettyref}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{booktabs}
\usepackage{units}
\usepackage{url}
\usepackage{pdfpages}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{makeidx}
\makeindex
\usepackage{graphicx}
\usepackage{setspace}
\PassOptionsToPackage{normalem}{ulem}
\usepackage{ulem}
\usepackage{nomencl}
% the following is useful when we have the old nomencl.sty package
\providecommand{\printnomenclature}{\printglossary}
\providecommand{\makenomenclature}{\makeglossary}
\makenomenclature
\usepackage[unicode=true,
 bookmarks=true,bookmarksnumbered=false,bookmarksopen=true,bookmarksopenlevel=2,
 breaklinks=true,pdfborder={0 0 0},backref=false,colorlinks=true]
 {hyperref}
\hypersetup{pdftitle={ImageJ User Guide },
 pdfauthor={Tiago Ferreira \& Wayne Rasband},
 pdfsubject={ImageJ 1.46 Handbook},
 pdfkeywords={ImageJ, Fiji, Scientific Digital Image Processing},
 hyperindex=true, linkcolor={black!65}, citecolor={black!65}, urlcolor={blue!40!black}, pdfstartview=FitH, pdfpagelayout=OneColumn}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
\pdfpageheight\paperheight
\pdfpagewidth\paperwidth

\newcommand{\noun}[1]{\textsc{#1}}
\DeclareRobustCommand*{\lyxarrow}{%
\@ifstar
{\leavevmode\,$\triangleleft$\,\allowbreak}
{\leavevmode\,$\triangleright$\,\allowbreak}}
%% Special footnote code from the package 'stblftnt.sty'
%% Author: Robin Fairbairns -- Last revised Dec 13 1996
\let\SF@@footnote\footnote
\def\footnote{\ifx\protect\@typeset@protect
    \expandafter\SF@@footnote
  \else
    \expandafter\SF@gobble@opt
  \fi
}
\expandafter\def\csname SF@gobble@opt \endcsname{\@ifnextchar[%]
  \SF@gobble@twobracket
  \@gobble
}
\edef\SF@gobble@opt{\noexpand\protect
  \expandafter\noexpand\csname SF@gobble@opt \endcsname}
\def\SF@gobble@twobracket[#1]#2{}
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}
%% A simple dot to overcome graphicx limitations
\newcommand{\lyxdot}{.}

\floatstyle{ruled}
\newfloat{infobox}{htb}{loi}
\providecommand{\infoboxname}{Noteworthy}
\floatname{infobox}{\protect\infoboxname}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\makeatletter
  %%%%%%%%%%%% Page Layout
    % We want a screen reading pdf without odd/even margin assymetry and a booklet-like print
    % version created by pdfpages. For the booklet version we will place the marginal todonotes on
    % the outer margin, saving space in the inner margin of the booklet. We will use the option
    % <twoside> to alternate marginpars, then eliminate symmetry with the geometry package. We will
    % increase <textwidth> and <textheight>. NB: fancyhdr must be loaded after geometry parameters!
    \usepackage[a4paper, twoside, hmarginratio={1:1},margin=2.58cm]{geometry}
    \usepackage{mparhack} % correct the notorious bug of misplaced mpar on top of page
    %\reversemarginpar % force all subsequent marginal notes to be put on the opposite side

  %%%%%%%%%%%% File size
    %\pdfcompresslevel=9 % default: 9
    %\pdfminorversion=5 % increase PDF version so that compression can be used, default: 5
    %\pdfobjcompresslevel=2 % compress non-stream objects, default: 2
    %\usepackage{cmap} % use real Unicode characters instead of TeX compounds for non-ASCII chars

  %%%%%%%%%%%% General
    \usepackage{ifthen}
    \usepackage{microtype} % micro-typographic extensions of pdfTEX
    \usepackage{sectsty} % sections font control
    \usepackage{appendix} % appendices control
    \usepackage[amssymb,textstyle]{SIunits} % get the upright'\micro'
    \usepackage{textcomp} % e.g., to produce \textquotesingle

  %%%%%%%%%%%% Fix for Acrobat Readers 
    % By default Acrobat Readers use DeviceCMYK. At least with AR 8 and 9, converted RGB colors are
    % shifted and ill rendered, so we'll make sure AR will use DeviceRGB
    \pdfpageattr{/Group <</S /Transparency /I true /CS /DeviceRGB>>}

  %%%%%%%%%%%% Adjust headers
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    %%% Get Dates to place in footer
    \newcommand{\revisiondate}{{\the\year/\/\two@digits{\the\month}/\/\two@digits{\the\day}}}
    %%% Adjust parameters
    \renewcommand{\headrulewidth}{0pt} %default is 0.4pt? 
    \fancyhead{}
    \renewcommand{\sectionmark}[1]{\markboth{#1}{}}
    \renewcommand{\subsectionmark}[1]{\markright{#1}{}}
    \rhead{\scriptsize\rightmark}
    \lhead{\scriptsize\leftmark}
    \fancyfoot[R]{\scriptsize{}Last updated: \revisiondate}
    %\fancyfoot[C]{}\fancyfoot[R]{\scriptsize\thepage}

  %%%%%%%%%%%%  Adjust Floats
    \usepackage[below]{placeins} % floats are not placed before the section, less demanding than strict
    %%% Adjust captions. Default preset for caption skip is 10pt
    \usepackage[font=small]{caption} % textformat=period
    \captionsetup[figure]{labelformat=empty,position=bottom,skip=5pt}
    \captionsetup[table]{labelformat=empty,position=top,skip=5pt}
    %%% Center all tables and figure floats
    \renewenvironment{figure}[1][]{%
        \ifthenelse{\equal{#1}{}}{\@float{figure}}{\@float{figure}[#1]}\centering
    }{\end@float}
    \renewenvironment{table}[1][]{%
        \ifthenelse{\equal{#1}{}}{\@float{table}}{\@float{table}[#1]}\centering
    }{\end@float}

  %%%%%%%%%%%%  Adjust Listings
    \usepackage{listings, xcolor}
    \colorlet{lstfcolor}{gray}% color of frame to be used in caption and lstset
    \colorlet{lstbcolor}{lstfcolor!10} % color of background to be used in lset
  
    % Define a new caption style for listings: We'll insert a tcolorbox to match 'noteworthy' floats
    \DeclareCaptionFormat{listing}{
        \begin{tcolorbox}[coltext=white,colback=lstfcolor,colframe=lstfcolor,boxsep=0pt,top=2pt,bottom=2pt,left=4pt,boxrule=0.4mm]
        {#1#2#3}
        \end{tcolorbox}\vspace*{-7.6pt}
    }
    % Adjust lstlisting caption
    \captionsetup[lstlisting]{%
        format=listing, labelformat=parens, font={small,bf}, labelsep=space, listformat=parens, singlelinecheck=false
    }
    \providecommand*{\lstlistingname}{} %\footnotesize\textsc{Macro}
    \renewcommand*{\lstlistingname}{}   %\footnotesize\textsc{Macro}
    \lstdefinelanguage{ijm} {
        language= java,
      % comments: italic green in Fiji
        commentstyle=\slshape\color[RGB]{0,200,0},
      % strings: magenta(?) in Fiji
        stringstyle=\color[RGB]{140,0,140},
      % operators: brown(?) in Fiji
        otherkeywords={+,-,=,<,!,\&},
        keywordstyle=\color[RGB]{130,60,0},
      % digits: gray(?) in Fiji
        alsoletter={1234567890},
        emph={[3]1,2,3,4,5,6,7,8,9,0,16,32,111,121,132,255,256},
        emphstyle=[3]\color[RGB]{50,50,50},
      % statements: bold blue in Fiji
        emph={[2]var,macro,function,return,true,false,if,then,else,for,while,do,length},
        emphstyle=[2]\color[RGB]{0,0,200}\bf,
      %IJ v1.46 built-in macro functions: golden(?) in Fiji
        emph={abs, acos, Array.concat, Array.copy, Array.fill, Array.getStatistics, Array.print, Array.rankPositions, Array.reverse, Array.slice, Array.sort, Array.trim, asin, atan, atan2, autoUpdate, beep, bitDepth, calibrate, call, changeValues, charCodeAt, close, cos, d2s, Dialog.create, Dialog.addMessage, Dialog.addString, Dialog.addNumber, Dialog.addSlider, Dialog.addCheckbox, Dialog.addCheckboxGroup, Dialog.addChoice, Dialog.addHelp, Dialog.setInsets, Dialog.show, Dialog.getString, Dialog.getNumber, Dialog.getCheckbox, Dialog.getChoice, doCommand, doWand, drawLine, drawOval, drawRect, drawString, dump, endsWith, eval, exec, exit, exp, Ext, File.append, File.close, File.dateLastModified, File.delete, File.directory, File.exists, File.getName, File.getParent, File.isDirectory, File.lastModified, File.length, File.makeDirectory, File.name, File.nameWithoutExtension, File.open, File.openAsString, File.openAsRawString, File.openUrlAsString, File.openDialog, File.rename, File.saveString, File.separator, fill, fillOval, fillRect, Fit.doFit, Fit.rSquared, Fit.p, Fit.nParams, Fit.f, Fit.nEquations, Fit.getEquation, Fit.plot, Fit.logResults, Fit.showDialog, floodFill, floor, fromCharCode, getArgument, getBoolean, getBoundingRect, getCursorLoc, getDateAndTime, getDimensions, getDirectory, getDisplayedArea, getFileList, getHeight, getHistogram, getImageID, getImageInfo, getInfo, getLine, getList, getLocationAndSize, getLut, getMetadata, getMinAndMax, getNumber, getPixel, getPixelSize, getProfile, getRawStatistics, getResult, getResultLabel, getSelectionBounds, getSelectionCoordinates, getSliceNumber, getStatistics, getString, getStringWidth, getThreshold, getTime, getTitle, getValue, getVoxelSize, getVersion, getWidth, getZoom, IJ, deleteRows, getToolName, freeMemory, currentMemory, maxMemory, pad, redirectErrorMessages, renameResults, imageCalculator, indexOf, is, isActive, isKeyDown, isNaN, isOpen, lastIndexOf, lengthOf, lineTo, List.set, List.get, List.getValue, List.size, List.clear, List.setList, List.getList, List.setMeasurements, List.setCommands, log, makeEllipse, makeLine, makeOval, makePoint, makePolygon, makeRectangle, makeSelection, makeText, matches, maxOf, minOf, moveTo, newArray, newImage, newMenu, nImages, nResults, nSlices, open, Overlay.moveTo, Overlay.lineTo, Overlay.drawLine, Overlay.add, Overlay.setPosition, Overlay.drawRect, Overlay.drawEllipse, Overlay.drawString, Overlay.show, Overlay.hide, Overlay.hidden, Overlay.remove, Overlay.size, Overlay.removeSelection, Overlay.copy, Overlay.paste, parseFloat, parseInt, PI, Plot.create, Plot.setLimits, Plot.setFrameSize, Plot.setLineWidth, Plot.setColor, Plot.add, Plot.addText, Plot.setJustification, Plot.drawLine, Plot.show, Plot.update, Plot.getValues, pow, print, random, rename, replace, requires, reset, resetMinAndMax, resetThreshold, restorePreviousTool, restoreSettings, roiManager, round, run, runMacro, save, saveAs, saveSettings, screenHeight, screenWidth, selectionContains, selectionName, selectionType, selectImage, selectWindow, setAutoThreshold, setBackgroundColor, setBatchMode, setColor, setFont, setForegroundColor, setJustification, setKeyDown, setLineWidth, setLocation, setLut, setMetadata, setMinAndMax, setOption, setPasteMode, setPixel, setResult, setRGBWeights, setSelectionLocation, setSelectionName, setSlice, setThreshold, setTool, setupUndo, setVoxelSize, setZCoordinate, showMessage, showMessageWithCancel, showProgress, showStatus, sin, snapshot, split, sqrt, Stack.isHyperstack, Stack.getDimensions, Stack.setDimensions, Stack.setChannel, Stack.setSlice, Stack.setFrame, Stack.getPosition, Stack.setPosition, Stack.getFrameRate, Stack.setFrameRate, Stack.getFrameInterval, Stack.setFrameInterval, Stack.getUnits, Stack.setTUnit, Stack.setZUnit, Stack.setDisplayMode, Stack.getDisplayMode, Stack.setActiveChannels, Stack.getActiveChannels, Stack.swap, Stack.getStatistics, startsWith, String.resetBuffer, String.append, String.buffer, String.copy, String.copyResults, String.getResultsHeadings, String.paste, substring, tan, toBinary, toHex, toLowerCase, toolID, toScaled, toUnscaled, toString, toUpperCase, updateDisplay, updateResults, wait, waitForUser},%
        emphstyle=\color[RGB]{165,65,0},
      % other settings
        sensitive=true, upquote=true, showstringspaces=false,
    }
    \lstset{%
        language=ijm, float=htb, captionpos=t,
        frame=tblr, framerule=0.4mm, rulecolor=\color{lstfcolor},
        xleftmargin=13.15pt, framexleftmargin=9pt, framexrightmargin=-4.2pt,%
        backgroundcolor=\color{lstbcolor},
        numbers=left, numbersep=3pt, numberstyle=\tiny,
        breaklines=true, breakatwhitespace=true, breakindent=15pt,
        prebreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
        basicstyle=\footnotesize\ttfamily,
    }

  %%%%%%%%%%%%  Adjust Footnotes
    \usepackage[perpage,hang,flushmargin]{footmisc}
    % adjust footnoterule
    \addtolength{\skip\footins}{3mm}
    \renewcommand\footnoterule{\kern-3\p@\hrule\@width1\columnwidth\kern2.6\p@}
    % make arabic footnote marks inside minipages (to be used in tables)
    \let\thempfootnote\thefootnote
    % define an unnumbered footnote (without footmark)
    \def\blfootnote{\xdef\@thefnmark{}\@footnotetext}

  %%%%%%    Fix for hyperfootnotes
    % hyperfootnotes= false must be loaded as an option. it has no effect in the in hypersetup. As of this
    % writings LyX does not allow to load this option in the Document properties. This will impose it
    \toks@\expandafter{%
        \expandafter\ifHy@hyperfootnotes
            \@footnotemark
            \else \H@@footnotemark
            \fi}
    \xdef\@footnotemark{\the\toks@}%
    \let\footnotes@ve = \footnote
    \def\footnote{\Hy@hyperfootnotesfalse\footnotes@ve}

  %%%%%%%%%%%%  Adjust index
    \usepackage{multicol}
    \renewenvironment{theindex}{
        \if@twocolumn \@restonecolfalse \else \@restonecoltrue \fi
        \setlength{\columnseprule}{0pt}
        \setlength{\columnsep}{35pt}
        \flushleft
        \begin{multicols}{3}[\section*{\indexname}]
        %\markboth{\MakeUppercase\indexname}{\MakeUppercase\indexname}%
            \setlength{\parindent}{0pt}
            \setlength{\parskip}{0.3pt}
            \relax\let\item\@idxitem}%
        {\end{multicols}
        \if@restonecol\onecolumn\else\clearpage\fi}
    \renewcommand\@idxitem{\par\hangindent 20\p@}
    \renewcommand\subitem{\@idxitem \hspace*{10\p@}}
    \renewcommand\subsubitem{\@idxitem \hspace*{20\p@}}
    %\renewcommand\indexspace{\par \vskip 5\p@ \@plus5\p@ \@minus3\p@\relax}

  %%%%%%%%%%%%  Adjust Nomenclature
    \usepackage{nomencl}
    \renewcommand{\nomname}{List of Abbreviations and Acronyms}%
    \setlength{\nomlabelwidth}{.18\hsize}%
    \renewcommand{\nomlabel}[1]{#1 \dotfill}%
    \setlength{\nomitemsep}{3.6pt}%
    \renewcommand{\nomentryend}{;}%
    \renewcommand*\nompreamble{
        \setlength{\columnsep}{12mm} %width between the multicols columns
        \flushleft\footnotesize\begin{multicols*}{2}}%
    \renewcommand*\nompostamble{\end{multicols*}}%

  %%%%%%%%%%%%  Define the "Noteworthy" float
    % We could define a new type of float but we'll instead customize the default "ruled" style
    % (see http://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions)
    \usepackage{float}
    \usepackage{tcolorbox}
    \tcbuselibrary{skins} % loads tikz
    \usetikzlibrary{shadings,shadows}
    % Tweak the ruled style: hack a tcolorbox inside the float
    \colorlet{shadecolor}{green!15} %will be used by cellcolor in doc
    \renewcommand\floatc@ruled[2]{{\@fs@cfont #1 #2}\par}
    \renewcommand\fs@ruled{
        %\def\@fs@cfont{\bfseries}\let\@fs@capt\floatc@ruled
        \def\@fs@pre{%
            \vspace*{5pt}
            \begin{tcolorbox}[%
                skin=beamer, boxrule=0.4mm, colback=shadecolor, colframe=shadecolor!70!black, left=2.5mm,
                before={\hspace*{-0.025\columnwidth}\begin{minipage}{1.05\columnwidth}},
                after={\end{minipage}}]
            }
        \def\@fs@mid{\kern10pt}%
        \def\@fs@post{
            \end{tcolorbox}
            \vspace*{5pt}
            \kern0pt\relax
            }%
        \let\@fs@iftopcapt\iftrue}
    
    % Customize caption of infoboxes
    % define float. Use empty label and correct its aligment. issues with labelformat=simple in captionsetup?
    \floatname{infobox}{\protect\hspace*{-3.8pt}}
    % \theinfobox will only be created if a \infobox exists in the document so we'll provide it here
    \providecommand{\theinfobox}{}
    \renewcommand{\theinfobox}{\Roman{infobox}} % Use Roman numerals
    % Roman numerals will overflow numwidth in the toc, this is just a lame fix to move them slightly left
    \DeclareCaptionListFormat{myinfobox}{\hspace*{-8pt}\theinfobox}
    \captionsetup[infobox]{listformat=myinfobox,labelsep=quad,font={sc,bf},singlelinecheck=false}

  %%%%%%%%%%%%  hyperref
    \usepackage{hyperref}
    \urlstyle{same} % kill the default monospaced font
    \providecommand*{\phantomsection}{} % Avoid all sorts of troubles

  %%%%%%%%%%%%  Use todonotes as call-outs
    \usepackage[shadow]{todonotes}
    \usepackage{setspace} % we'll need custom spacing inside the todonote
    \newcounter{todocounter}
    \newcommand{\todonum}[2][]{\stepcounter{todocounter}\todo[#1]{\thetodocounter: #2}}
    \setlength{\marginparwidth}{2cm} % tidy the todonote width
    \newcommand{\feature}[1]{ % new label
        \ifthenelse{\equal{#1}{}}{
        \todo[noline,size=\footnotesize, backgroundcolor=green!20!white,bordercolor=green!60!white,nolist]{
        \vspace*{-16pt}\begin{spacing}{0.8}\center\textsc{New in IJ\,\theguideversion}\end{spacing}\vspace*{1pt}}
        }{
        \todo[noline,size=\footnotesize, backgroundcolor=green!20!white,bordercolor=green!60!white,caption={#1}]{
            \vspace*{-16pt}\begin{spacing}{0.8}\center\textsc{New in IJ\,\theguideversion}\end{spacing}\vspace*{1pt}}
        }
    }
    \newcommand{\change}[1]{ % changes label
        \ifthenelse{\equal{#1}{}}{
        \todo[noline,size=\footnotesize, backgroundcolor=red!20!white, bordercolor=red!60!white, nolist]{
        \vspace*{-16pt}\begin{spacing}{0.85}\center\textsc{Changed in IJ\,\theguideversion}\end{spacing}\vspace*{1pt}}
        }{
        \todo[noline,size=\footnotesize, backgroundcolor=red!20!white, bordercolor=red!60!white, caption={#1}]{
        \vspace*{-16pt}\begin{spacing}{0.85}\center\textsc{Changed in IJ\,\theguideversion}\end{spacing}\vspace*{1pt}}
        }
    }
    \newcommand{\improvement}[1]{ % improvements label
        \ifthenelse{\equal{#1}{}}{
        \todo[noline,size=\footnotesize, backgroundcolor=yellow!20!white, bordercolor=yellow!60!white,nolist]{
        \vspace*{-16pt}\begin{spacing}{0.85}\center\textsc{Improved in IJ\,\theguideversion}\end{spacing}\vspace*{1pt}}
    }{
        \todo[noline,size=\footnotesize, backgroundcolor=yellow!20!white, bordercolor=yellow!60!white,caption={#1}]{
        \vspace*{-16pt}\begin{spacing}{0.85}\center\textsc{Improved in IJ\,\theguideversion}\end{spacing}\vspace*{1pt}}
        }
    }

  %%%%%%%%%%%   load menuitems: Menus and keystrokes
    \usepackage{menukeys}
      \renewmenumacro{\keys}[+]{shadowedroundedkeys} % separator: +
      \renewmenumacro{\directory}[/]{hyphenatepaths}
      %\renewmenumacro{\menu}[>]{menus}
    
  %%%%%%%%%%%   Define globally the version Guide, Title, etc..
    \providecommand{\theguideversion}{??}
\makeatother
\newenvironment{lyxlist}[1]
{\begin{list}{}
{\settowidth{\labelwidth}{#1}
 \setlength{\leftmargin}{\labelwidth}
 \addtolength{\leftmargin}{\labelsep}
 \renewcommand{\makelabel}[1]{##1\hfil}}}
{\end{list}}
 \newcommand{\calso}[1]{%
 \begin{list}{}
     {\settowidth{\labelwidth}{SeeAlsoo::}
      \setlength{\leftmargin}{\labelwidth}
      \addtolength{\leftmargin}{\labelsep}
      \renewcommand{\makelabel}[1]{\small\textsc{See\ also:}\hfil}}
 \item #1
 \end{list}}
 %%%%%%%%%%%% Create the list of Release Notes (Features, Improvements and Changes)
 \providecommand{\makelistofhighlights}[1]{
     \phantomsection
     \addcontentsline{toc}{section}{Release Notes for ImageJ \theguideversion}
     %% There seems to be an issue (with tocloft?) and todonotes that creates bogus title in the list of todonotes. The problem
     %% goes away by unloading toclof. The following "tabular" is a really ugly fix to provide a properly foormated title
     \listoftodos[\hspace*{-11pt}\begin{tabular}{l}\cellcolor{white}\textbf{\Large{#1}}\end{tabular}\vspace*{\medskipamount}]
 }
 %%%%%%%%%%%% Create the list of Listings
 \newcommand*{\makelistoflistings}[1]{
     \ifthenelse{\NOT\equal{#1}{}}{\renewcommand{\lstlistlistingname}{#1}}{}
     \phantomsection
     \addcontentsline{toc}{section}{\lstlistlistingname}
     \lstlistoflistings
 }
 \newcommand*{\userinterface}[1]{{\sffamily #1}}
 \providecommand*{\mykeystroke}[1]{{\keys{{#1}}}}
 \newcommand*{\filenameref}[2][]{{\textcolor{black!90}{\relsize{-0.4}\winmenuwin\,\ttfamily{\directory{#1}{#2}}}}}
 \newcommand*{\dirnameref}[2][]{{\textcolor{black!90}{\relsize{-0.4}\drawtikzfolder\,\ttfamily{\directory{#1}{#2}}}}}
\newcommand{\code}[1]{\texttt{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%%%%%%%%%%%% Adjust TOC
\usepackage{tocloft}
\addtolength{\cftsubsecnumwidth}{6pt} % make space for more than 10 subsections
\addtolength{\cftsubsubsecnumwidth}{1em} % make space for more than 10 subsubsections
\cftpagenumbersoff{part} % remove page numbers from Part

%%%%%%%%%%%% Colors
\usepackage{colortbl} % colored tables
\definecolor{ijcyan}{RGB}{0,255,255}
\definecolor{ijmagenta}{RGB}{255,0,255}
\definecolor{ijorange}{RGB}{255,150,0}%actual:255,200,0
\definecolor{ijyellow}{RGB}{255,255,0}

%%%%%%%%%%%% Make paragraphs into subsubsubsections
\setcounter{secnumdepth}{4} % get numbered paragraphs 
\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}% 
  {-3.25ex\@plus -1ex \@minus -.2ex}%
  {1.5ex \@plus .2ex}%
  {\normalfont\normalsize\bfseries}}
\makeatother

%%%%%%%%%%%  Set special dates
\usepackage{datetime}

\AtBeginDocument{
  \def\labelitemi{\scriptsize\normalfont\bfseries{--}}
}

\makeatother

\addto\captionsamerican{\renewcommand{\infoboxname}{Noteworthy}}

\begin{document}
\renewcommand{\theguideversion}{1.46p}

\includepdf{\lyxdot \lyxdot /cover/CoverMain}

\pagenumbering{roman}

%Title
\thispagestyle{empty}
\begin{center}
\pdfbookmark[1]{Foreword}{ForewordNote}
%\sffamily
\begin{minipage}[c][3cm][t]{1.3cm}%
   \includegraphics{images/IJ-icon-cover}%
 \end{minipage}
\begin{minipage}[c]{09.4cm}%
   \setlength{\tabcolsep}{0pt}
   \begin{tabular}{c} 
   \multicolumn{1}{l}{
       \textcolor{black!75}{\textbf{\Huge ImageJ User Guide}}}
   \tabularnewline[0.2cm]
   \hline 
   \noalign{\vskip6pt}
   \multicolumn{1}{r}{\textcolor{black!75}{\textbf{\LARGE \hfill{}IJ\,\theguideversion{}}}}
   \tabularnewline[0.7cm]
   \multicolumn{1}{c}{\textcolor{black!75}{\Large
     \href{mailto:tiago.ferreira@mail.mcgill.ca}{Tiago Ferreira}
     ~{$^{\footnotesize\bullet}$}~
     \href{mailto:wsr@nih.gov}{Wayne Rasband}}}
   \tabularnewline
   \end{tabular}
\end{minipage}\\
\vspace*{\fill}
\today
\par\end{center}
\vspace*{1cm}

%Frontnote
\begin{quote}
\hrulefill\qquad\textsc{Foreword}\qquad\hrulefill
\vspace*{\medskipamount}

The \emph{ImageJ User Guide} provides a detailed overview of ImageJ
(and inherently \nameref{sub:Fiji-intro}), the standard in scientific
image analysis.

It was thought as a comprehensive, fully-searchable, self-contained,
annotatable manual (\emph{see} \nameref{sec:Guide-Conventions}).
A \nomenclature{HTML}{HyperText Markup Language}HTML version is also
available as well as printer-friendly booklets (\emph{see} \nameref{sec:Guide-Formats}).
Its latest version can always be obtained from \url{http://imagej.nih.gov/ij/docs/guide}.
The source files are available through a Git version control repository
at \url{http://fiji.sc/guide.git}. 

\noindent Given ImageJ's heavy development this guide will always
remain incomplete. All ImageJ users and developers are encouraged
to contribute to the ImageJ documentation resources (\emph{see} \nameref{sub:Getting-Involved}).

\hrulefill
\end{quote}
%\vspace*{2.0cm}

\clearpage{}

\pagestyle{plain}

%TOC
 \pdfbookmark[1]{Contents}{tableofcontents}

\tableofcontents{}

\clearpage{}

\blfootnote{Please note that this is not an extensive list. Detailed release notes
for version\,\theguideversion{} are available on the ImageJ news
web site: \url{http://imagej.nih.gov/ij/notes.html}.}

\makelistofhighlights{Summarized Release Notes for ImageJ\,\theguideversion{}}\label{listoffeatures}

\clearpage{}

%Noteworthy
\phantomsection
\addcontentsline{toc}{section}{Noteworthy}
\phantomsection
\begin{doublespace}
\noindent

\listof{infobox}{Noteworthy}
\label{noteworthylist}

\end{doublespace}

\clearpage{}

%Listings
\phantomsection
\begin{doublespace}
\noindent

\makelistoflistings{Macro Listings}\label{macrolistingslist}

\end{doublespace}

\clearpage{}

\thispagestyle{empty}


\section*{Guide Formats\label{sec:Guide-Formats}}

This guide is available in the following formats:
\begin{lyxlist}{00.00.0000}
\item [{\textbf{Enhanced\ PDF}}] Optimized for electronic viewing and
highly enriched in hypertext links (\emph{see} \nameref{sec:Guide-Conventions}).
Available at \url{http://imagej.nih.gov/ij/docs/guide/user-guide.pdf}.
\item [{\textbf{HTML\ document}}] available online at \url{http://imagej.nih.gov/ij/docs/guide/}.
For offline usage a downloadable ZIP archive is also available at
\url{http://imagej.nih.gov/ij/docs/user-guide.zip}.
\item [{\textbf{Printable\ booklets}}] Two-sided booklets that can be
printed on a duplex unit printer by setting the automatic duplex mode
to ``short edge binding''. Two formats are available: A4 (\url{http://imagej.nih.gov/ij/docs/guide/user-guide-A4booklet.pdf})
and letter size paper (\url{http://imagej.nih.gov/ij/docs/guide/user-guide-USbooklet.pdf}).
\end{lyxlist}
\phantomsection
\addcontentsline{toc}{section}{Conventions}


\section*{Conventions Used in this Guide\label{sec:Guide-Conventions}}

\noindent Throughout the guide, internal  links are displayed in gray
(e.g., Part \prettyref{par:User-Interface1} \nameref{par:User-Interface1}).
Links to external URLs, such as the \href{http://imagej.nih.gov/ij/}{ImageJ website},
\url{http://imagej.nih.gov/ij/}, are displayed in dark blue.

\noindent ImageJ commands are typed in \textsf{sans\ serif} typeface
with respective shortcut keys flanked by square brackets (e.g.:\ \textsf{\userinterface{\noindent \textsf{Image\lyxarrow{}\nameref{sub:Duplicate...[D]}}}}).
As explained in \nameref{sub:Using-Shortcuts}, this notation implies
Shift-modifiers (i.e., \userinterface{\noindent {[}D{]}} means pressing
\mykeystroke{Shift} \mykeystroke{D}, \userinterface{\noindent {[}d{]}}
only the \mykeystroke{D} key) and assumes that \emph{Require control
key for shortcuts }in \textsf{\userinterface{\textsf{Edit\lyxarrow{}Options\lyxarrow{}\nameref{sub:Misc...}}}}
is unchecked. Note that references to the \mykeystroke{Ctrl} key
include the \mykeystroke{\cmd\  Cmd} key of Macintosh keyboards. 

\noindent Useful tips and reminders are placed in `Noteworthy notes'
numbered with upper case roman numerals (e.g., \ref{infobox:Frontmost-window}
\nameref{infobox:Frontmost-window}). The full list of these notes
is available \vpageref{noteworthylist}.

Filenames, directories and file extensions are typed in monospaced
font marked by a related icon, e.g., file \filenameref{StartupMacros.txt}
in folder \dirnameref{/Applications/ImageJ/macros/}.

\noindent Macro functions and code snippets are typed in monospaced
font, e.g., \texttt{\code{\noindent \texttt{resetMinAndMax()}}}.
Scripts and macros are numbered with arabic numerals included in parentheses
(e.g., \eqref{lis:RGBtoMGB1} \nameref{lis:RGBtoMGB1} \vpageref{lis:RGBtoMGB1})
and typeset with the same \index{Syntax highlighting}syntax markup
provided by the \nameref{sub:Fiji-Scrip-Editor}. The full list of
macro listings is available \vpageref{macrolistingslist}.

\noindent Selected highlights of version\,\theguideversion{} are
listed \vpageref{listoffeatures} and flagged with colored marginal
notes. These should be interpreted as:\medskip{}


\begin{minipage}[c][1\totalheight][t]{0.27\columnwidth}%
\qquad{}%
\begin{minipage}[c][1\totalheight][t]{2cm}%
\todo[inline,size=\footnotesize, backgroundcolor=green!20!white,bordercolor=green!60!white,nolist]{ 	\vspace*{-16pt}\begin{spacing}{0.8}\center\textsc{New in IJ\,\theguideversion}\end{spacing}\vspace*{1pt} }%
\end{minipage}%
\end{minipage}%
\begin{minipage}[c][1\totalheight][t]{0.73\columnwidth}%
\begin{singlespace}
\noindent {\small A new feature implemented in ImageJ\,\theguideversion{}.}\end{singlespace}
%
\end{minipage}\smallskip{}


\begin{minipage}[c][1\totalheight][t]{0.27\columnwidth}%
\qquad{}%
\begin{minipage}[c][1\totalheight][t]{2cm}%
\todo[inline,size=\footnotesize, backgroundcolor=yellow!20!white, bordercolor=yellow!60!white,nolist]{ 	\vspace*{-16pt}\begin{spacing}{0.8}\center\textsc{Improved in IJ\,\theguideversion}\end{spacing}\vspace*{1pt} }%
\end{minipage}%
\end{minipage}%
\begin{minipage}[c][1\totalheight][t]{0.73\columnwidth}%
\begin{singlespace}
\noindent {\small A routine that has been improved since previous
versions. Typically, a faster or more precise algorithm, a command
with better usability, or a task that has been extended to more image
types. }\end{singlespace}
%
\end{minipage}\smallskip{}


\begin{minipage}[c][1\totalheight][t]{0.27\columnwidth}%
\qquad{}%
\begin{minipage}[c][1\totalheight][t]{2cm}%
\todo[inline,size=\footnotesize, backgroundcolor=red!20!white, bordercolor=red!60!white,nolist]{ 	\vspace*{-16pt}\begin{spacing}{0.8}\center\textsc{Changed in IJ\,\theguideversion}\end{spacing}\vspace*{1pt} }%
\end{minipage}%
\end{minipage}%
\begin{minipage}[c][1\totalheight][t]{0.73\columnwidth}%
\begin{singlespace}
\noindent {\small A pre-existing command that has been renamed or
moved to a different menu location in ImageJ\,\theguideversion{}.}\end{singlespace}
%
\end{minipage}

\clearpage{}

\pagenumbering{arabic}
\pagestyle{fancy}
\thispagestyle{plain}

\include{01-intro}

\clearpage{}

\thispagestyle{plain}

\include{02-working}

\clearpage{}

\thispagestyle{plain}

\include{03-extending}\clearpage{}

\thispagestyle{plain}
\sectionmark{The ImageJ Window}

\include{04-gui}\clearpage{}



\thispagestyle{plain}% no headings on the first page

%% In the TOC, do not show page numbers for sections (IJ Menus)
\addtocontents{toc}{\protect\cftpagenumbersoff{section}}\include{05-commands}

%% Restore sections page numbers in the TOC 
  \addtocontents{toc}{\protect\cftpagenumberson{section}}

\clearpage{}

\thispagestyle{plain}% no headings on the first page
\sectionmark{Listof Shortcuts}

\include{06-shortcuts}\clearpage{}

\pagestyle{plain}
\pdfbookmark[0]{Addenda}{addenda}

%Credits
\renewcommand{\refname}{Credits}
\phantomsection
\addcontentsline{toc}{section}{\refname}
\makeatletter % @ is now a letter
  \def\bibleftdelim{\hspace*{-30pt}[C}
  \def\bibrightdelim{]}
  \def\@biblabel#1{\bibleftdelim #1\bibrightdelim}
\makeatother % @ is a symbol
\small{}

\include{07-credits}

% biblio fix: reset item labels
\makeatletter % @ is now a letter
  \def\bibleftdelim{[}
  \def\bibrightdelim{]}
  \def\@biblabel#1{\bibleftdelim #1\bibrightdelim}
\makeatother % @ is a symbol

\clearpage{}

\include{08-biblio}\clearpage{}

%Nomenclature
 \phantomsection
 \addcontentsline{toc}{section}{\nomname}
 \printnomenclature


\clearpage{}

%Index
\phantomsection
\addcontentsline{toc}{section}{\indexname}


\printindex{}

\clearpage{}

\phantomsection
\pagestyle{empty}
\addcontentsline{toc}{section}{Colophon}

\include{09-about}
\end{document}
